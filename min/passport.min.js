const passport=require("passport"),localStrategy=require("passport-local").Strategy,models=require("./models.js"),passportJWT=require("passport-jwt"),users=models.user,jwtStrategy=passportJWT.Strategy,extractJWT=passportJWT.ExtractJwt;passport.use(new localStrategy({usernameField:"username",passwordField:"password"},(async(username,password,callback)=>{console.log(`${username} ${password}`),await users.findOne({username:username}).then((user=>user?(console.log("finished"),callback(null,user)):(console.log("incorrect username"),callback(null,!1,{message:"Incorrect username or password."})))).catch((error=>{if(error)return console.log(error),callback(error)}))}))),passport.use(new jwtStrategy({jwtFromRequest:extractJWT.fromAuthHeaderAsBearerToken(),secretOrKey:"your_jwt_secret"},(async(jwtPayload,callback)=>await users.findById(jwtPayload._id).then((user=>callback(null,user))).catch((error=>callback(error))))));