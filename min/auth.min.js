const jwt=require("jsonwebtoken"),passport=require("passport");require("./passport.js");const jwtSecret="your_jwt_secret",generateJWTToken=user=>jwt.sign(user,jwtSecret,{subject:user.username,expiresIn:"7d",algorithm:"HS256"});module.exports=router=>{router.post("/login",((req,res)=>{passport.authenticate("local",{session:!1},((error,user,info)=>{if(error||!user)return res.status(400).json({message:"Something is not right",user:user}).end();req.login(user,{session:!1},(error=>{if(!error){const token=generateJWTToken(user.toJSON());return res.json({user:user,token:token}).end()}res.send(error)}))}))(req,res)}))};